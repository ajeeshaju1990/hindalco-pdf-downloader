name: Download Hindalco PDF Daily

on:
  schedule:
    # Every day at 6:30 AM IST (i.e., 1:00 AM UTC)
    - cron: "30 1 * * *"
  workflow_dispatch:

jobs:
  download-pdf:
    name: Download and Commit PDF
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repository
      uses: actions/checkout@v3

    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: "3.11"

    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        pip install selenium requests

    - name: Set up Chrome for headless Selenium
      uses: browser-actions/setup-chrome@latest

    - name: Run the Python script
      run: python hindalco_downloader.py

    - name: Get current time for commit message
      uses: josStorer/get-current-time@v2.0.2
      id: current-time
      with:
        format: "dddd, MMMM Do YYYY, h:mm:ss a"
        utcOffset: "+05:30"

    - name: Commit downloaded PDF
      uses: stefanzweifel/git-auto-commit-action@v4
      with:
        commit_message: "Auto Commit: Hindalco PDF on ${{ steps.current-time.outputs.formattedTime }}"
        commit_user_name: github-actions
        commit_user_email: actions@github.com
        file_pattern: "*.pdf"
